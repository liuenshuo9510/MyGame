<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Tomb Runner is an online Web3-inspired game where Web2 users can dive into thrilling adventures and explore blockchain-powered experiences." />
  <link rel="canonical" href="https://tombrunner.fun" />
  <title>Tomb Runner | Web3 Adventure Awaits</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Roboto, sans-serif;
      background-color: #181A20;
      color: #EAECEF;
    }

    header {
      text-align: center;
      padding: 80px 20px 60px;
    }

    header h1 {
      font-size: 3.2em;
      font-weight: bold;
      color: #F0B90B;
      margin: 0;
    }

    header p {
      font-size: 1.4em;
      color: #EAECEF;
      margin-top: 10px;
    }

    .cta-button {
      background-color: #F0B90B;
      color: #181A20;
      padding: 15px 35px;
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      margin-top: 30px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .cta-button:hover {
      background-color: #d9a500;
    }

    .section {
      max-width: 960px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    h2 {
      color: #F0B90B;
      font-size: 2em;
      margin-bottom: 20px;
    }

    p {
      line-height: 1.7;
      font-size: 1.1em;
      color: #ccc;
    }

    iframe {
      width: 100%;
      height: 600px;
      border: none;
      border-radius: 10px;
      background: #111;
      margin-top: 30px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
    }

    .wallet-button {
      background-color: #0071e3;
      color: white;
      padding: 15px 40px;
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      margin-top: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .wallet-button:hover {
      background-color: #005bb5;
    }

    .comment-section {
      margin-top: 40px;
      background: #2d2f34;
      padding: 20px;
      border-radius: 8px;
    }

    .comment {
      background: #333;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 6px;
    }

    .comment span {
      font-weight: bold;
      color: #F0B90B;
    }

    .comment-form {
      display: flex;
      flex-direction: column;
      margin-top: 20px;
    }

    .comment-form textarea {
      background: #222;
      border: 1px solid #444;
      color: #EAECEF;
      padding: 10px;
      font-size: 1em;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    .comment-form button {
      background-color: #F0B90B;
      color: #181A20;
      padding: 10px;
      font-size: 1.1em;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .comment-form button:hover {
      background-color: #d9a500;
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 2.2em;
      }

      .cta-button {
        padding: 12px 24px;
        font-size: 1em;
      }

      iframe {
        height: 400px;
      }

      .wallet-button {
        padding: 12px 30px;
      }
    }
  </style>
</head>
<body>
  <!-- Hero -->
  <header>
    <h1>Millions of Web2 Users</h1>
    <p>are discovering Web3 through Tomb Runner</p>
    <a href="#play">
      <button class="cta-button">Play Now</button>
    </a>
    <!-- Web3 Wallet Connect Button -->
    <button class="wallet-button" id="connectWalletButton">Connect Wallet</button>
    <p id="walletStatus" style="margin-top: 20px; color: #EAECEF;"></p>
  </header>

  <!-- Game Overview -->
  <div class="section">
    <h2>Game Overview</h2>
    <p>
      Tomb Runner is an exciting online game where you guide your character through ancient ruins, dodge deadly traps, and collect treasures. Fast-paced and fun, it's the perfect casual game for all ages—with a twist of Web3.
    </p>
  </div>

  <!-- Vision Section -->
  <div class="section">
    <h2>Our Vision: Bridging Web2 to Web3</h2>
    <p>
      Tomb Runner is more than just a game—it's a gateway. We aim to onboard millions of Web2 players into the Web3 ecosystem through fun, familiar experiences. By embedding blockchain mechanics into traditional gameplay, we create a seamless transition into the decentralized world.
    </p>
  </div>

  <!-- Game Embed -->
  <div class="section" id="play">
    <h2>Play Tomb Runner</h2>
    <p>
      Jump right into the action—no install needed. Your adventure begins now.
    </p>
    <iframe src="https://u4i856.online" title="Tomb Runner Game"></iframe>
  </div>

  <!-- Why Play -->
  <div class="section">
    <h2>Why Play Tomb Runner?</h2>
    <p>
      • Accessible from any browser, any device<br />
      • Fast-paced gameplay with Web3 integration<br />
      • No wallet or crypto knowledge needed to start<br />
      • A thrilling escape from boring afternoons
    </p>
  </div>

  <!-- Comment Section -->
  <div class="comment-section">
    <h2>Game Reviews</h2>
    <div id="commentsContainer"></div>
    
    <div class="comment-form">
      <textarea id="commentText" placeholder="Leave a comment..." rows="4"></textarea>
      <button id="submitCommentButton">Submit Comment</button>
    </div>
  </div>

  <!-- Web3 Wallet Connection -->
  <script>
    const connectButton = document.getElementById('connectWalletButton');
    const walletStatus = document.getElementById('walletStatus');
    const submitCommentButton = document.getElementById('submitCommentButton');
    const commentText = document.getElementById('commentText');
    const commentsContainer = document.getElementById('commentsContainer');
    
    let userAddress = null;

    // Check if window.ethereum is available (MetaMask or other Ethereum wallet)
    if (window.ethereum) {
      connectButton.addEventListener('click', async () => {
        try {
          // Request wallet connection
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });

          // Show connected wallet address
          userAddress = accounts[0];
          walletStatus.innerHTML = `Connected: ${userAddress.substring(0, 6)}...${userAddress.substring(userAddress.length - 4)}`;
          walletStatus.style.color = '#F0B90B'; // Gold color for status
        } catch (error) {
          // Handle error if wallet connection fails
          walletStatus.innerHTML = 'Connection failed. Please try again.';
          walletStatus.style.color = 'red';
        }
      });
    } else {
      walletStatus.innerHTML = 'Please install MetaMask to connect your wallet.';
      walletStatus.style.color = 'red';
    }

    // Fetch and display comments
    async function loadComments() {
      const response = await fetch('http://54.183.66.163:5000/comments');
      const comments = await response.json();

      commentsContainer.innerHTML = ''; // Clear existing comments

      comments.forEach((comment) => {
        const commentElement = document.createElement('div');
        commentElement.className = 'comment';
        commentElement.innerHTML = `<span>${comment.userAddress.substring(0, 6)}...${comment.userAddress.substring(comment.userAddress.length - 4)}</span>: ${comment.comment}`;
        commentsContainer.appendChild(commentElement);
      });
    }

    // Submit comment
    submitCommentButton.addEventListener('click', async () => {
        if (!userAddress) {
            alert('Please connect your wallet first!');
            return;
        }

        const comment = commentText.value.trim();
        if (comment.length > 0) {
            console.log('Submitting comment:', { userAddress, comment });

            try {
                const response = await fetch('http://54.183.66.163:5000/comments', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        userAddress: userAddress,
                        comment: comment,
                    }),
                });
                console.log('Response from backend:', response);

                if (response.ok) {
                    loadComments(); // Refresh comments list
                    commentText.value = ''; // Clear input
                } else {
                    alert('Error submitting comment');
                }
            } catch (error) {
                console.log('Error during fetch:', error);
                alert('Error submitting comment');
            }
        }
    });


    // Load comments when the page loads
    loadComments();
  </script>
</body>
</html>
